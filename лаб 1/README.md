# Разработка модели для прогнозирования популярности продуктов на основе анализа отзывов пользователей и трендов покупок
Проект реализован на модели LDA из средств для работы с текстом NLP. Позволяет выделить ключевые темы из отзывов о товаре.


## Запуск:
Проект доступен по этой ссылке на мой блокнот google colab (https://colab.research.google.com/drive/11sTYp8TWbfqfWEDhJBRfYzaEnC8lvJCS?usp=sharing).

На всякий случай если вдруг ссылка не сработала:
1) Скачать файл Сортировка трендов(1).ipynb.
2) Создать новый блокнот google colab и загрузить туда файл.
3) Скачать датасет 7817_1.csv и загрузить его гугл диск.
4) Подключить гугл диск в гугл колабе и скопировать путь к файлу в строку с определением датафрейма в коде.
   
## Описание Проекта:
Датасет я взял с kaggle со статистикой сайта Amazon (https://www.kaggle.com/datasets/yasserh/amazon-product-reviews-dataset).

Я решил использовать модель Latent Dirichlet Allocation (LDA) т.к. здесь идет работа с текстом. Она используется для выделения тем и оценке согласованности тем с использованием coherence score. Эти шаги позволяют нам понять, какие темы наиболее релевантны для анализа популярности продуктов. Coherence score - это метрика, используемая для оценки качества тематической модели, такой как Latent Dirichlet Allocation (LDA). Она предоставляет количественную меру того, насколько хорошо темы, выделенные моделью, интерпретируемы и связаны друг с другом


1. **Подготовка данных:**
   - Загрузка и фильтрация данных отзывов о продуктах, выбор конкретного продукта (например, Amazon Echo).

2. **Токенизация и Предварительная Обработка:**
   - Использование библиотеки Gensim для токенизации отзывов и удаления стоп-слов. Применение лемматизации для преобразования слов в их базовые формы.

3. **Создание Словаря и Корпуса:**
   - Построение словаря и корпуса для применения модели LDA.

4. **Построение Модели LDA:**
   - Использование Gensim для построения модели LDA, выделения тем и вывода ключевых слов для каждой темы.

5. **Оценка Coherence Score:**
   - Вычисление coherence score для определения качества модели LDA.

6. **Выбор Окончательной Модели:**
   - Построение нескольких моделей LDA с разным количеством тем и alpha, а затем выбор наилучшей модели с учетом coherence score.

7. **Визуализация Тем:**
   - Использование библиотеки pyLDAvis для визуализации тем и их влияния на популярность продуктов.

---

## Вывод и результат
Данный проект реализован с помощью модели LDA и позволяет анализировать продукты на маркетплейсах (популярные слова, которые используют в отзыве о товаре).

Вышеупомянутая модель LDA построена на 10 различных темах, где каждая тема представляет собой комбинацию ключевых слов, и каждое ключевое слово вносит определенный вес в тему. На скриншоте показаны 10 тем, в каждой из которых есть топ-10 слов со своим весом, которые и формируют эту тему (отзыв). Вы можете увидеть ключевые слова для каждой темы и вес (важность) каждого ключевого слова на фото:
![Скриншот 21-01-2024 010257](https://github.com/pozhiloychelovek/iskintellekt/assets/127489085/ea5e8f03-b9aa-4cb2-b6f5-28a6d4cc52b5)

---
![1234](https://github.com/pozhiloychelovek/iskintellekt/assets/127489085/fec01f5b-4cde-4171-9201-b499ec09fc71)

Каждый пузырь на левом графике представляет тему. Чем больше пузырь, тем больше распространена эта тема.

Хорошая тематическая модель будет иметь довольно большие непересекающиеся пузыри, разбросанные по всей диаграмме, а не сгруппированные в одном квадранте.

Модель со слишком большим количеством тем, как правило, имеет много перекрытий, пузырьки небольшого размера, сгруппированные в одной области диаграммы.

Если вы наведете курсор на один из пузырей и справа обновятся полосы графиков. Эти слова являются ключевыми словами, они формируют выбранную тему.

---

Вообще, всё завязано на параметре coherence (отображает связанность, чем выше тем лучше; !но так же нужно смотреть и на то какие слова используются в теме, какой вес имеет документ и исходя из этого всего можно выбрать оптимальный вариант) и количестве тем. Поэтому имеет смысл создавать несколько моделей с разным кол-вом тем и смотреть у кого выше этот коэф. 
В данной таблице можно увидеть значения связанности для разного кол-ва тем. 
![image](https://github.com/pozhiloychelovek/iskintellekt/assets/127489085/a698e20b-e8de-42e1-afa4-e1d2dabbbc1d)

Выбираем лучший вариант (на основе значений Alpha и coherence) и создаем ещё раз модель.
![image](https://github.com/pozhiloychelovek/iskintellekt/assets/127489085/137935a9-76cc-493e-bf40-a59491951b64)

Теперь мы получили топ из 6 тем с оптимальным значением связанности, где в каждой теме показаны топ 30 слов которые используются наиболее часто о товаре.

---
#### Ссылки на используемые ресурсы.
Опирался на материал из статьи: https://webdevblog.ru/tematicheskoe-modelirovanie-s-pomoshhju-gensim-python/. 
