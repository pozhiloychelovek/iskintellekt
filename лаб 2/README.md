# Инструмент для автоматической генерации аннотаций к текстам
По данной теме я использовал методы обработки естественного языка (NLP) для создания краткого и смыслового резюме текста. При написании опирался на видео одного разработчика. Используется TextRank алгоритм.

## Запуск:
Проект доступен по этой ссылке на мой блокнот google colab (https://colab.research.google.com/drive/1urs9lvGPpDKHzAHW1pI_5rMgf6-AyHBr?usp=sharing).

На всякий случай если вдруг ссылка не сработала:
1) Скачать файл Аннотация_к_тексту.ipynb.
2) Создать новый блокнот google colab и загрузить туда файл.
3) Скачать датасет по ссылке с Kaggle [https://www.kaggle.com/datasets/snapcrack/all-the-news] и загрузить его на гугл диск.
4) Подключить гугл диск в гугл колабе и скопировать путь к файлу в строку с определением датафрейма в коде.

## Описание
Датасет: https://www.kaggle.com/datasets/snapcrack/all-the-news.

1. **Выбор модели**: Использование TextRank для автоматической суммаризации текста. Относительно простой и эффективный метод. 

2. **Обработка текста**: Использование библиотеки NLP для предварительной обработки текста. Тут сталкиваемся с задачами, такими как извлечение ключевых слов и оценка схожести предложений.

**TextRank**: Алгоритм основан на оценке схожести предложений, что помогает выделить ключевые фрагменты текста.
TextRank - это алгоритм для извлечения ключевых идей из текста и создания кратких аннотаций. Этот метод основан на PageRank, алгоритме, который используется для ранжирования веб-страниц. Мы заменяем веб-страницы на предложения текста и оцениваем их схожесть, чтобы выделить важные фрагменты.

## Выводы и результаты
Код предназначен для автоматической генерации краткого содержания статьи на основе предварительно обработанного текста. Длина краткого содержания не задается напрямую, но в коде есть параметр, который определяет, какую часть предложений с наивысшими оценками использовать для формирования краткого содержания. В данном случае используется 25% самых высокооцененных предложений:

```python
select_length = int(len(summ) * 0.25)
```

Если вам нужно изменить длину краткого содержания, вы можете изменить значение 0.25 на другую долю в диапазоне от 0 до 1.

Процесс работы кода следующий:
1. Входная статья предварительно обрабатывается с использованием ряда функций, таких как удаление HTML, обработка контракций, удаление стоп-слов и т. д.
2. После предварительной обработки для каждого предложения вычисляется оценка, основанная на нормализованной частоте слов.
3. После оценки всех предложений выбирается определенная доля (25%) предложений с наивысшими оценками, и они объединяются, чтобы составить краткое содержание.

Оценка предложения в данном контексте определяется на основе частоты слов в предложении и их нормализованных значений.

1. Для каждого предложения в статье подсчитывается частота встречаемости каждого слова.

2. После подсчета частоты слов для каждого предложения, эти значения нормализуются. Это означает, что каждое значение частоты слова делится на максимальное значение частоты слова в предложении. Таким образом, получается нормализованное значение частоты слова, приведенное к диапазону от 0 до 1.

3. Далее происходит проход по каждому предложению, и для каждого слова в предложении вычисляется суммарное нормализованное значение его частоты.

4. Эти суммарные значения формируют оценку предложения. Таким образом, предложения с более высокой суммарной нормализованной частотой слов получают более высокие оценки.

Это означает, что предложения, содержащие слова с более высокой нормализованной частотой, считаются более важными и получают более высокие оценки. Этот подход предполагает, что важность предложения зависит от частоты встречаемости в нем ключевых слов, которые представляют ценные смысловые элементы статьи.
Этот метод оценки предложений может быть эффективным для выделения наиболее информативных частей статьи при автоматическом создании краткого содержания.

В итоге получаем, что исходный текст сокращается в несколько раз. Вот статья на 14 тысяч слов:
![image](https://github.com/pozhiloychelovek/iskintellekt/assets/127489085/c8c496ec-8f35-43d1-b0f9-6c666e9235a3)

А теперь её сокращенный вариант с сохранением смысла исходного текста: 
![image](https://github.com/pozhiloychelovek/iskintellekt/assets/127489085/02845d8b-9437-4b40-9963-2a1d0d2bca2e)

