# Инструмент для автоматической генерации аннотаций к текстам RU

Этот проект представляет собой инструмент для автоматической генерации аннотаций к текстам на русском языке. Тут используются сразу две предобученные модели: для сжатия текста или для генерации аннотации.

## Запуск кода

#### Проект находится в публичном доступе на kaggle.
Открыть его можно по ссылке: https://www.kaggle.com/code/andrewsh102rus/text-summary-ru/notebook.
Файл с блокнотом прикреплен тут.

## Используемые модели

1. **Модель для сжатия текста (cointegrated/rubert-tiny2-sentence-compression):**
   - **Принцип работы:** Модель определяет важность каждого слова в предложении, вычисляет вероятность его удаления и создает сжатый текст.
   - **Параметры:**
     - *Threshold (порог):* Определяет вероятность удаления слова. # Использовать если хотим удалить слова, вероятность у которых выше заданного значения.
     - *Keep Ratio (доля сохраняемых слов):* Пропорция сохраняемых слов. # Использовать если хотим сохранить долю слов.
     
     ```python
     def compress(text, threshold=0.5, keep_ratio=None):
     ```

2. **Модель для генерации краткого содержания (IlyaGusev/mbart_ru_sum_gazeta):**
   - **Принцип работы:** Модель mBART генерирует краткое содержание текста, используя метод генерации текста.
   - **Параметры:**
     - *no_repeat_ngram_size:* Параметр предотвращает повторение n-грамм в сгенерированном тексте. Если бы мы установили no_repeat_ngram_size=2, то генератор текста будет следить за тем, чтобы в сгенерированном тексте не появлялись повторяющиеся двухсловные последовательности. К примеру,
```python
"Париж - это столица Франции. Париж известен своими красивыми улицами и историческими памятниками."
```
Если использовалось слово "Париж", то следующей двухсловной последовательностью не может быть "Париж известен", потому что это уже встречалось в исходном тексте.

## Примеры использования

```python
# первая модель сжатия
from summarization_tool import compress, generate_summary

text_to_compress = "..."  # ваш текст для сжатия
# вторая модель генерации нового текста
compressed_text = compress(text_to_compress, threshold=0.5, keep_ratio=None)

text_to_summarize = "..."  # ваш текст для аннотации
summary = generate_summary(text_to_summarize)
```

## Результаты

- **Модель для сжатия текста:** Возвращает сжатый текст с учетом заданных параметров порога и доли сохраняемых слов. Как можно заметить из скриншота ниже есть недостатки, остались лишние предлоги, где-то может быть неправильное склонение и т.д. Всё же ей можно пользоваться если регулировать значение порога.
  ![image](https://github.com/pozhiloychelovek/iskintellekt/assets/127489085/31da04ef-c7e0-4aff-930b-21c4aac4f40a)

- **Модель для генерации краткого содержания:** Генерирует краткое содержание введенного текста. В этой модели извлекается смысл текста и формируется новый текст. Выглядит намного лучше на мой взгляд. Доп. скрины тестов ниже.
  ![image](https://github.com/pozhiloychelovek/iskintellekt/assets/127489085/aa8f823c-6169-42da-917e-456ee00328a2)
  
### Доп.тесты:
Сравним 2 модели на одном и том же тексте:
```python
text = '''
Как считает британское должностное лицо, российские достижения усложнили проведение Украиной контрнаступления,
а также вынудили ее прибегать к тактикам, более соответствующим эпохе Второй мировой войны, например, больше полагаться на использование танков.

Украинское контрнаступление началось 4 июня 2023 года, а спустя три месяца президент России Владимир Путин констатировал:
"контрнаступ" не то что буксует, "это провал".

В январе Путин отмечал, что Украина провалила контрнаступление, инициатива находится в руках российских Вооруженных сил,
и если так будет продолжаться, скоро встанет вопрос об украинской государственности.

Как сообщал 19 декабря министр обороны РФ Сергей Шойгу, в ходе своего контрнаступления ВСУ потеряли 159 тысяч военнослужащих,
121 самолет, 766 танков, включая 37 "Леопардов".

Ранее Шойгу заявлял, что поставки западного вооружения и ввод в бой украинским командованием стратегических резервов не изменили ситуацию на поле боя.
'''
```

**1 модель**
```python
text = '''
keep_ratio=0.7 Как считает британское должностное лицо, российские достижения усложнили проведение Украиной контрнаступления,
а также вынудили ее прибегать к тактикам, более соответствующим эпохе Второй мировой войны, больше полагаться на использование танков.
контрнаступление началось 4 июня 2023 года, а спустя три месяца президент России Владимир констатировал : " контрнаступ "
не то буксует " ". провалила контрнаступление, инициатива находится в руках российских Вооруженных сил об. РФ ВСУ потеряли
159 тысяч, 121 самолет, 766 танков Леопардов " что поставки западного вооружения и ввод в бой украинским командованием
стратегических резервов не изменили ситуацию на поле боя.
'''
```

**2 модель**
```python
text = '''
Российские достижения усложнили проведение Украиной контрнаступления,
а также вынудили ее прибегать к тактикам, более соответствующим эпохе Второй мировой войны,
например, больше полагаться на использование танков.
'''
```

### Итог

- **Модель для сжатия текста:** Нужно изменять значения порога и доли сохраняемых слов для достижения оптимального уровня сжатия.
- **Модель для генерации краткого содержания:** Полученное краткое содержание является хорошим описанием введенного текста.

### Использованные материалы
https://www.kaggle.com/datasets/phoenix120/gazeta-summaries/data
https://huggingface.co/IlyaGusev/rubert_ext_sum_gazeta
https://habr.com/ru/articles/566486/
